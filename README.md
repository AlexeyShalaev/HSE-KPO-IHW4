# Документация проекта TicketService

## Запуск проекта

Перед запуском проекта необходимо установить Docker и Docker Compose. Инструкции по установке можно найти на официальном сайте Docker: https://docs.docker.com/get-docker/

Убедитесь, что Docker и Docker Compose запущены на вашем компьютере.

База данных в проекте использует PostgreSQL. По умолчанию использует порт 15432. Если порт занят, измените его в файле docker-compose.yml.

Для запуска проекта необходимо ввести следующую команду в терминале:
`docker compose up --build`

## Краткое описание проекта

Данный проект представляет собой систему микросервисов для обработки заказов на покупку билетов. Она состоит из двух основных компонентов: сервиса аутентификации (AuthService) и сервиса обработки заказов (TicketService). Система разработана для управления заказами на покупку билетов, предоставляя возможность регистрации пользователей, аутентификации, создания и обработки заказов.

## Архитектура системы

### Сервисы

Система построена на основе микросервисной архитектуры, где каждый компонент является независимым сервисом, обеспечивающим определенную функциональность.

#### AuthService

Микросервис AuthService отвечает за аутентификацию и регистрацию пользователей. Он предоставляет RESTful API для выполнения следующих операций:
- Регистрация нового пользователя
- Вход пользователя в систему
- Получение информации о текущем пользователе

Для аутентификации пользователей используется JWT (JSON Web Token). При успешной аутентификации пользователю выдается токен, который может быть использован для последующих запросов.

#### TicketService

Микросервис TicketService отвечает за управление заказами на покупку билетов. Он предоставляет RESTful API для выполнения следующих операций:
- Создание нового заказа на покупку билета
- Получение информации о заказах

Система TicketService также имеет фоновую задачу для обработки заказов. Это позволяет автоматически обновлять статус заказов, например, отмечать их как успешные или отклоненные, что обеспечивает более плавную работу системы.

## Структура каждого микросервиса
Контроллеры
Контроллеры отвечают за обработку HTTP запросов и направление их к соответствующим сервисам.

### DTO (Data Transfer Objects)
DTO используются для передачи данных между клиентом и сервером. Они содержат только необходимую информацию и помогают обеспечить чистоту кода и безопасность передачи данных.

### Модель
Модели представляют собой объекты данных, которые хранятся в базе данных или передаются между компонентами системы.

### Репозитории
Репозитории обеспечивают взаимодействие с базой данных для выполнения операций CRUD (Create, Read, Update, Delete) с объектами модели.

### Сервисы
Сервисы содержат бизнес-логику приложения. Они обрабатывают запросы, взаимодействуют с репозиториями и выполняют различные операции, необходимые для функционирования приложения.

### Утилиты
Утилиты предоставляют вспомогательные функции, такие как аутентификация и обработка JWT токенов.

## API Эндпоинты

### AuthService

- **POST** `/auth/register` - Регистрация нового пользователя
- **POST** `/auth/login` - Аутентификация пользователя
- **GET** `/auth/me` - Получение информации о текущем пользователе

### TicketService

- **POST** `/ticket/orders` - Создание нового заказа на покупку билетов
- **GET** `/ticket/orders/{orderId}` - Получение информации о заказе по его идентификатору
- **GET** `/station/all` - Получение списка всех станций

## Документация Swagger

- [AuthService](http://localhost:8000/swagger-ui/index.html)
- [TicketService](http://localhost:8080/swagger-ui/index.html)

## Список использованных технологий

- Java 17
- Kotlin 1.9.23
- Spring Boot 3.2.5
- jjwt 0.9.1
- springdoc-openapi-starter-webmvc-ui 2.3.0
- spring-boot-starter-actuator
- spring-boot-starter-data-jpa
- spring-boot-starter-web
- jackson-module-kotlin
- kotlin-reflect
- kotlin-stdlib
- postgresql (runtime)
- spring-security-test (test)
- jaxb-api 2.3.1
- spring-security-crypto
- spring-boot-test (test)
- testng (test)
- junit (test)
- junit-jupiter (test)
- spring-boot-test-autoconfigure (test)